(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{459:function(e,s,a){"use strict";a.r(s);var t=a(30),r=Object(t.a)({},(function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"k8s-修改master的ip"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#k8s-修改master的ip"}},[e._v("#")]),e._v(" k8s 修改Master的Ip")]),e._v(" "),a("h2",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[e._v("#")]),e._v(" 前言")]),e._v(" "),a("p",[e._v("昨天本地机器停电, 重启之后, 发现Master节点对应的机器ip变了")]),e._v(" "),a("p",[e._v("目前找到了重置的办法, 原先的服务还需要重新启一遍, 如何实现只改IP配置 保留原有服务, 还需要继续研究研究")]),e._v(" "),a("h2",{attrs:{id:"解决过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决过程"}},[e._v("#")]),e._v(" 解决过程")]),e._v(" "),a("p",[e._v("在Master上执行")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("sudo kubeadm reset\nsudo kubeadm init\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("这样就可以重新生成新的join命令")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("sudo kubeadm join 192.168.12.78:6443 --token pqi2ud.mhpaxlp4l7i0dbu8 \\\n--discovery-token-ca-cert-hash sha256:17115c0c6e62a5ce4e13fb859e2b25b277815f6064cdc3c88a21f04b99588ea2   \n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("删掉原先的配置")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("rm -rf $HOME/.kube\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("接下来按照提示执行")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("mkdir -p $HOME/.kube\nsudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\nsudo chown $(id -u):$(id -g) $HOME/.kube/config\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("p",[e._v("记住还要重装网络插件")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("kubectl apply -f \"https://cloud.weave.works/k8s/net?k8s-version=$(kubectl version | base64 | tr -d '\\n')\"\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("其他Worker节点执行")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("sudo kubeadm reset\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("然后重新加入即可")]),e._v(" "),a("h2",{attrs:{id:"参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[e._v("#")]),e._v(" 参考资料")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://blog.csdn.net/u013355826/article/details/82786649",target:"_blank",rel:"noopener noreferrer"}},[e._v("kubernetes安装过程中错误（kube-dns 状态一直是Pending，master节点是NotReady）"),a("OutboundLink")],1),e._v(" 谦190")]),e._v(" "),a("li",[a("a",{attrs:{href:"http://www.linuxqq.com/archives/1803.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("kubernetes 更换master ip"),a("OutboundLink")],1),e._v(" 小Q")])])])}),[],!1,null,null,null);s.default=r.exports}}]);